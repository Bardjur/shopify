{%- style -%}
  .section-{{ section.id }} {
    background: #e7e3cc;
  }
  .tabs{
    border: 1px solid rgba(0, 0, 0, 0.3);
    border-radius: 10px;
    padding: 10px;
  }
  .tabs-nav {
    margin-bottom:10px;
  }
  .tabs .tab-nav-btn {
    border-radius: 10px;
    border: none;
    padding: 12px 0px;
    width: 100%;
    background: rgba(52, 50, 15, 0.1);
    font-weight: 700;
    font-size: 16px;
    line-height: 100%;
    color: #34320f;
  }
  .tabs .tab-nav-btn:not(:last-child){
    margin-bottom:5px;
  }
  .tabs .tab-nav-btn.active{
    color: #f1eeda;
    background: #34320f;
  }
  .tabs-body{
    border-radius: 10px;
    padding: 20px;
    background: rgba(255, 255, 255, 0.6);
  }
  .tabs .tab{
    /*display:none;*/
  }
  .tabs .tab.active{
    display:block;
  }

{%- endstyle -%}

<div class="section-{{ section.id }}">
  {%- if section.settings.header != blank -%}
    <h2>{{ section.settings.header }}</h2>
  {%- endif -%}

  <div class="tabs">
    <div class="tabs-nav">

    </div>

    <div class="tabs-body">
      {% content_for 'blocks' %}
    </div>
  </div>


</div>
<script>
document.addEventListener("DOMContentLoaded", (event) => {
   const tabsBlock = document.querySelector(".section-{{ section.id }} .tabs");
  
  const nav = tabsBlock.querySelector(".section-{{ section.id }} .tabs-nav");
  const tabs = tabsBlock.querySelectorAll(".tabs-body .tab");

  const navBtn = Array.from(tabs)
      .map((pane) => {
        return {
          id: pane.id,
          title: pane.dataset.caption || 'Tab',
        };
      })

      navBtn.forEach((tab) => {
      const btn = document.createElement('button');
      btn.className = 'tab-nav-btn';
      btn.textContent = tab.title;
      btn.dataset.tab = tab.id;

{% comment %}       btn.addEventListener('click', () => {
        // hide all
        tabPanes.forEach(pane => pane.style.display = 'none');
        // show selected
        document.getElementById(tab.id).style.display = 'block';

        // update active tab
        document.querySelectorAll('.tab-nav-btn').forEach(btn => btn.classList.remove('active'));
        btn.classList.add('active');
      }); {% endcomment %}

      tabsNav.appendChild(btn);
    });

  const buttons = tabsBlock.querySelectorAll(".tabs-nav .tab-nav-btn");
  buttons.forEach(btn => btn.addEventListener('click', openTab));

  function openTab(){
    const activeTab = this.dataset.order;
    changeClass(activeTab, buttons);
    changeClass(activeTab, tabs);
  }

  function changeClass(activeTab, elems){
    elems.forEach(elem => {
      console.log(elem);
      if( activeTab == elem.dataset.tab){
        elem.classList.add('active')
      } else {
        elem.classList.remove('active')
      }
    });
  } 
console.log(buttons);
  tabs.forEach(tab => {

  })

});
</script>

{% schema %}
  {
    "name": "Tabs",
    "tag":"section",
    "class": "section",
    "blocks": [{"type": "_tab_content"}],
    "settings": [
      {
        "type": "text",
        "id": "header",
        "label": "Header"
      }
    ],
    "presets":[{
      "name": "Tabs",
      "blocks": [
        { "type": "_tab_content", "settings": { "tab_order": 1 } },
      ]
    }]
  }
{% endschema %}